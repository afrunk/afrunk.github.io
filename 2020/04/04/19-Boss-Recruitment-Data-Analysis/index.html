<!DOCTYPE html>
<html lang>
  <head><meta name="generator" content="Hexo 3.9.0"><meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">


<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">

<meta name="theme-color" content="#f8f5ec">
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">

<meta name="description" content="Boss Recruitment Data Analysis"><meta name="keywords" content="Django, afrunk"><link rel="alternate" href="/default" title="afrunk"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=2.11.0">
<link rel="canonical" href="http://afrunk.github.io/2020/04/04/19-Boss-Recruitment-Data-Analysis/">

<link rel="stylesheet" type="text/css" href="/lib/fancybox/jquery.fancybox.css"><link rel="stylesheet" type="text/css" href="/lib/nprogress/nprogress.min.css"><script type="text/x-mathjax-config">
    MathJax.Hub.Config({ tex2jax: { inlineMath: [['$','$'], ['\\(','\\)']] } });
  </script>
  <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<link rel="stylesheet" type="text/css" href="/css/style.css?v=2.11.0">

<script id="baidu_push">
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>
<script>
  window.config = {"leancloud":{"app_id":null,"app_key":null},"toc":true,"fancybox":true,"pjax":true,"latex":true};
</script>

    <title>Boss Recruitment Data Analysis - afrunk</title>
  </head>

  <body><div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/." class="logo">afrunk</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>

<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list"><a href="/">
        <li class="mobile-menu-item">Home
          </li>
      </a><a href="/archives/">
        <li class="mobile-menu-item">Archivew
          </li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags
          </li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories
          </li>
      </a><a href="/MachineLearning/">
        <li class="mobile-menu-item">机器学习
          </li>
      </a></ul>
</nav>
<div class="container" id="mobile-panel">
      <header id="header" class="header"><div class="logo-wrapper">
  <a href="/." class="logo">afrunk</a>
</div>

<nav class="site-navbar"><ul id="menu" class="menu"><li class="menu-item">
          <a class="menu-item-link" href="/">
            Home
            </a>
        </li>
      <li class="menu-item">
          <a class="menu-item-link" href="/archives/">
            Archivew
            </a>
        </li>
      <li class="menu-item">
          <a class="menu-item-link" href="/tags/">
            Tags
            </a>
        </li>
      <li class="menu-item">
          <a class="menu-item-link" href="/categories/">
            Categories
            </a>
        </li>
      <li class="menu-item">
          <a class="menu-item-link" href="/MachineLearning/">
            机器学习
            </a>
        </li>
      </ul></nav>
</header>

      <main id="main" class="main">
        <div class="content-wrapper">
          <div id="content" class="content"><article class="post">
    <header class="post-header">
      <h1 class="post-title">Boss Recruitment Data Analysis
        </h1>

      <div class="post-meta">
        <span class="post-time">
          2020-04-04
        </span><span class="post-category">
            <a href="/categories/实战项目/">实战项目</a>
            </span>
        </div>
    </header>

    <div class="post-toc" id="post-toc">
    <h2 class="post-toc-title">文章目录</h2>
    <div class="post-toc-content">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Spyder"><span class="toc-text">Spyder</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Part-0-如何使用-Selenium"><span class="toc-text">Part 0 如何使用 Selenium</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Part-1-破解-Selenium-被识别问题"><span class="toc-text">Part 1 破解 Selenium 被识别问题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Part-2-定位元素"><span class="toc-text">Part 2 定位元素</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Part-3-翻页-城市定位-分类"><span class="toc-text">Part 3 翻页 城市定位 分类</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Part-4-数据库表"><span class="toc-text">Part 4 数据库表</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Part-5-整合代码"><span class="toc-text">Part 5 整合代码</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Django"><span class="toc-text">Django</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Start-Django"><span class="toc-text">Start Django</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#APP"><span class="toc-text">APP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Index"><span class="toc-text">Index</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Models"><span class="toc-text">Models</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Data"><span class="toc-text">Data</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Echart-And-Django"><span class="toc-text">Echart And Django</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#HTML、路由和视图函数-如何绑定"><span class="toc-text">HTML、路由和视图函数 如何绑定</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#完善视图函数"><span class="toc-text">完善视图函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Echart-Ajax-调用数据可视化"><span class="toc-text">Echart Ajax 调用数据可视化</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Conclusions"><span class="toc-text">Conclusions</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Reference"><span class="toc-text">Reference</span></a></li></ol>
    </div>
  </div><div class="post-content"><p>抓取 Boss 直聘 <strong>北京，上海，广州，深圳，杭州，天津，西安，武汉，长沙，成都，郑州，重庆</strong> 12个城市的招聘数据，进行可视化分析。需要实现如下效果：</p>
<ul>
<li>12个城市七个类目招聘信息的数据可视化部分</li>
<li>数据可视化需要有两个柱状图和一个数据分析总结</li>
</ul>
<p>本文的开发环境</p>
<ul>
<li>Django 2.2</li>
<li>Python 3.7</li>
<li>Mysql 8</li>
<li>Selenium 3.141.0</li>
<li>Chrome 78.0.3904.97<a id="more"></a>
</li>
</ul>
<h1 id="Spyder"><a href="#Spyder" class="headerlink" title="Spyder"></a>Spyder</h1><p>这里整理下思路，之前使用的是 <code>Request</code>、<code>BeautifulSoup</code> 来尝试获取页面信息，但是 <code>Boss</code> 直接反爬掉了，于是才有 <code>Selenium</code> 模拟浏览器的方法来抓取。</p>
<h2 id="Part-0-如何使用-Selenium"><a href="#Part-0-如何使用-Selenium" class="headerlink" title="Part 0 如何使用 Selenium"></a>Part 0 如何使用 Selenium</h2><p>首先我们需要安装 <code>selenium</code> ,在 Terminal 中输入 <code>pip install selenium</code> 即可实现安装。 <code>Selenium</code> 是一个用于 Web 应用程序测试的工具。直接在浏览器中运行，就像真正的用户在操作一样。支持包括但不限于 <code>Chrome</code> 和 <code>Firefox</code>。 <code>Selenium</code> 的核心 <code>Selenium Core</code> 基于 <code>JsUnit</code> ，完全由 <code>JavaScript</code> 编写，因此可以用于任何支持 <code>JavaScript</code> 的浏览器上。</p>
<p>这里要说一下比较重要的 <code>PhantomJS</code>,它是一个基于 <code>WebKit</code> 的服务器端 <code>JavaScript API</code>，支持浏览器而不需要浏览器支持，其快速，原生支持各种 Web 标准：Dom 处理，CSS 选择器，JSON 等等。<code>PhantomJS</code> 可以用于页面自动化、网络监测、网页截图以及无界面测试。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"></span><br><span class="line"><span class="comment"># 调用浏览器类型</span></span><br><span class="line">browser = webdriver.Chrome()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 访问页面链接</span></span><br><span class="line">url = <span class="string">'https:www.baidu.com'</span></span><br><span class="line">browser.get(url)<span class="comment"># 打开浏览器预设网址</span></span><br><span class="line">print(browser.page_source)<span class="comment"># 打印网页源代码</span></span><br><span class="line">browser.close()<span class="comment"># 关闭浏览器</span></span><br></pre></td></tr></table></figure>
<p>上述代码运行后，会自动打开 <strong>Chrome</strong> 浏览器，并打开百度首页，在终端输出百度首页的源代码，然后关闭浏览器。</p>
<h2 id="Part-1-破解-Selenium-被识别问题"><a href="#Part-1-破解-Selenium-被识别问题" class="headerlink" title="Part 1 破解 Selenium 被识别问题"></a>Part 1 破解 Selenium 被识别问题</h2><p>一开始我直接使用 <code>Selenium</code> 模拟的方法来抓取，但是 <code>Boss</code> 仍然可以识别到，我们尝试下面的模拟登陆的方式来躲避识别。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Cookies</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, driver)</span>:</span></span><br><span class="line">        self.driver = driver</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">save_cookies</span><span class="params">(self)</span>:</span></span><br><span class="line">        cookies = self.driver.get_cookies()</span><br><span class="line">        json_cookies = json.dumps(cookies)</span><br><span class="line">        <span class="comment"># 保存cookies，方便后续加载使用</span></span><br><span class="line">        <span class="keyword">with</span> open(<span class="string">'cookies.json'</span>, <span class="string">'w'</span>, encoding=<span class="string">'utf-8'</span>) <span class="keyword">as</span> f:</span><br><span class="line">            f.write(json_cookies)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">add_cookies</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="comment"># 加载前先清除之前的cooikes，防止影响</span></span><br><span class="line">        self.driver.delete_all_cookies()</span><br><span class="line">        <span class="keyword">with</span> open(<span class="string">'cookies.json'</span>, <span class="string">'r'</span>, encoding=<span class="string">'utf-8'</span>) <span class="keyword">as</span> f:</span><br><span class="line">            list_cookies = json.loads(f.read())</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> list_cookies:</span><br><span class="line">            self.driver.add_cookie(i)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    url = <span class="string">'https://www.zhipin.com/job_detail/?ka=header-job'</span></span><br><span class="line">    option = webdriver.ChromeOptions()</span><br><span class="line">    option.add_experimental_option(<span class="string">'excludeSwitches'</span>, [<span class="string">'enable-automation'</span>])</span><br><span class="line">    driver = webdriver.Chrome(<span class="string">'chromedriver.exe'</span>,options=option)</span><br><span class="line">    driver.maximize_window()</span><br><span class="line">    driver.get(url)</span><br><span class="line">    time.sleep(<span class="number">3</span>)</span><br><span class="line">    cookies = Cookies(driver)</span><br><span class="line">    <span class="comment"># # 保存cookies</span></span><br><span class="line">    <span class="comment"># cookies.save_cookies()</span></span><br><span class="line">    <span class="comment"># 加载cookies</span></span><br><span class="line">    cookies.add_cookies()</span><br><span class="line">    driver.get(url)</span><br><span class="line">    time.sleep(<span class="number">3</span>)</span><br></pre></td></tr></table></figure>
<p>将下面的代码中的添加到我们的 <code>Webdriver</code> 的声明中即可躲过反爬<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">option = webdriver.ChromeOptions()</span><br><span class="line">option.add_experimental_option(<span class="string">'excludeSwitches'</span>, [<span class="string">'enable-automation'</span>])</span><br></pre></td></tr></table></figure></p>
<h2 id="Part-2-定位元素"><a href="#Part-2-定位元素" class="headerlink" title="Part 2 定位元素"></a>Part 2 定位元素</h2><p>我们需要获取的是如下图所示的字段信息</p>
<p><img src="1.png" alt></p>
<p>如何来定位这些元素呢？我们打开 <code>Chrome</code> 浏览器，点击到我们的 公司名字 位置，右键检查，然后点击箭头选中位置</p>
<p><img src="2.png" alt></p>
<p>然后选择下方的 HTML 内容位置，右键 Copy - Copy XPath</p>
<p><img src="3.png" alt></p>
<p>Copy 出来的代码如下 <code>//*[@id=&quot;main&quot;]/div/div[2]/ul/li[1]/div/div[1]/div[2]/div/h3/a</code>,但是这只能定位到一个元素，如何去定位到列表的所有元素呢？我们再来选择一家招聘公司的名称,执行上面同样的操作 <code>//*[@id=&quot;main&quot;]/div/div[2]/ul/li[2]/div/div[1]/div[2]/div/h3/a</code>，由此可见不同的公司名称之间的区别就在于它们分别位于第几个 <code>li</code> 中。</p>
<p>这样子的话我们直接进行一个 <strong>for</strong> 循环，然后拼接成合适的定位元素，然后使用 <code>.text</code> 方法来获取文本内容，即可实现内容的抓取。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># 薪资</span><br><span class="line">try:</span><br><span class="line">    xinzi = self.driver.find_element_by_xpath(&apos;//*[@id =&quot;main&quot;]/div/div[2]/ul/li[&apos; + str(x) + &apos;]/div/div[1]/div[1]/div/div[2]/span&apos;).text</span><br><span class="line"></span><br><span class="line">except:</span><br><span class="line">    xinzi = &quot;&quot;</span><br></pre></td></tr></table></figure>
<h2 id="Part-3-翻页-城市定位-分类"><a href="#Part-3-翻页-城市定位-分类" class="headerlink" title="Part 3 翻页 城市定位 分类"></a>Part 3 翻页 城市定位 分类</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 城市名和城市代码同步定位 城市名入库数据库 城市代码用于拼接访问链接</span></span><br><span class="line">citys=[<span class="string">'北京'</span>,<span class="string">'上海'</span>,<span class="string">'广州'</span>,<span class="string">'深圳'</span>,<span class="string">'杭州'</span>,<span class="string">'天津'</span>,<span class="string">'西安'</span>,<span class="string">'武汉'</span>,<span class="string">'长沙'</span>,<span class="string">'成都'</span>,<span class="string">'郑州'</span>,<span class="string">'重庆'</span>]</span><br><span class="line">city_codes = [<span class="string">'101010100'</span>,<span class="string">'101020100'</span>,<span class="string">'101280100'</span>,<span class="string">'101280600'</span>,<span class="string">'101210100'</span>,<span class="string">'101030100'</span>,<span class="string">'101110100'</span>,<span class="string">'101200100'</span>,<span class="string">'101250100'</span>,<span class="string">'101270100'</span>,<span class="string">'101180100'</span>,<span class="string">'101040100'</span>]</span><br><span class="line"><span class="comment"># 爬取关键词列表</span></span><br><span class="line">gangwei_lst = [<span class="string">"Java"</span>, <span class="string">"Python"</span>, <span class="string">"PHP"</span>, <span class="string">"安卓"</span>, <span class="string">"大数据"</span>, <span class="string">"c/c++"</span>,<span class="string">"前端"</span>]</span><br><span class="line"><span class="comment"># 序号 作为数据库的唯一主键存在</span></span><br><span class="line">xuhao = <span class="number">1</span></span><br><span class="line"><span class="comment"># 遍历城市列表 用来访问所有城市的所有分类数据</span></span><br><span class="line"><span class="keyword">for</span> city_num <span class="keyword">in</span> range(len(citys)):</span><br><span class="line">    <span class="comment"># 城市名 数据库字段</span></span><br><span class="line">    city = citys[city_num]</span><br><span class="line">    <span class="comment"># 遍历所有的分类列表 抓取所有城市的所有分类数据</span></span><br><span class="line">    <span class="keyword">for</span> search <span class="keyword">in</span> gangwei_lst:</span><br><span class="line">        <span class="keyword">for</span> y <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">11</span>):</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                self.driver.switch_to.window(sreach_window)</span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                <span class="keyword">pass</span></span><br><span class="line">            <span class="comment"># 链接c后面的数字即城市代码</span></span><br><span class="line">            <span class="comment"># c 101020100 上海 101010100 北京 将城市代码拼接到访问链接来</span></span><br><span class="line">            url = <span class="string">'https://www.zhipin.com/c'</span>+str(city_codes[city_num])+<span class="string">'/?query='</span> + str(search) + <span class="string">'&amp;page='</span> + str(y) + <span class="string">'&amp;ka=page-'</span> + str(y)</span><br></pre></td></tr></table></figure>
<h2 id="Part-4-数据库表"><a href="#Part-4-数据库表" class="headerlink" title="Part 4 数据库表"></a>Part 4 数据库表</h2><p>为了避免重复抓取，所以构建了一个主键 <strong>id</strong> ，在最外层赋值为1，后续自增。抓取的数据字段只有9个，但是为了后续方便进行数据可视化，添加了额外的三个字段，即前面提到的主键 <strong>id</strong> 、城市、技术方向。</p>
<p><img src="4.png" alt></p>
<h2 id="Part-5-整合代码"><a href="#Part-5-整合代码" class="headerlink" title="Part 5 整合代码"></a>Part 5 整合代码</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">无头浏览器 模仿请求</span></span><br><span class="line"><span class="string">2020-4-4</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.chrome.options <span class="keyword">import</span> Options</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span> By</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.support.ui <span class="keyword">import</span> WebDriverWait                    <span class="comment"># available since 2.4.0</span></span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.support <span class="keyword">import</span> expected_conditions <span class="keyword">as</span> EC           <span class="comment"># available since 2.26.0</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="comment"># 数据库配置部分</span></span><br><span class="line"><span class="keyword">import</span> pymysql</span><br><span class="line">db = pymysql.connect(host=<span class="string">'127.0.0.1'</span>,</span><br><span class="line">                     port=<span class="number">3306</span>,</span><br><span class="line">                     user=<span class="string">'root'</span>, <span class="comment">#用户名</span></span><br><span class="line">                     password=<span class="string">'password'</span>, <span class="comment">#用户密码</span></span><br><span class="line">                     db=<span class="string">'boss_recruitment'</span>, <span class="comment"># 数据库名</span></span><br><span class="line">                     charset=<span class="string">'utf8'</span>)</span><br><span class="line">cursor = db.cursor() <span class="comment">#链接数据库</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 可视化</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="comment"># 破解selenium反爬类方法</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Cookies</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, driver)</span>:</span></span><br><span class="line">        self.driver = driver</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">save_cookies</span><span class="params">(self)</span>:</span></span><br><span class="line">        cookies = self.driver.get_cookies()</span><br><span class="line">        json_cookies = json.dumps(cookies)</span><br><span class="line">        print(json_cookies)</span><br><span class="line">        <span class="comment"># 保存cookies，方便后续加载使用</span></span><br><span class="line">        <span class="keyword">with</span> open(<span class="string">'cookies.json'</span>, <span class="string">'w'</span>, encoding=<span class="string">'utf-8'</span>) <span class="keyword">as</span> f:</span><br><span class="line">            f.write(json_cookies)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">add_cookies</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="comment"># 加载前先清除之前的cooikes，防止影响</span></span><br><span class="line">        self.driver.delete_all_cookies()</span><br><span class="line">        <span class="keyword">with</span> open(<span class="string">'cookies.json'</span>, <span class="string">'r'</span>, encoding=<span class="string">'utf-8'</span>) <span class="keyword">as</span> f:</span><br><span class="line">            list_cookies = json.loads(f.read())</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> list_cookies:</span><br><span class="line">            self.driver.add_cookie(i)</span><br><span class="line"><span class="comment"># 主要抓取类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Boss</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        option = webdriver.ChromeOptions()</span><br><span class="line">        option.add_experimental_option(<span class="string">'excludeSwitches'</span>, [<span class="string">'enable-automation'</span>])</span><br><span class="line">        self.driver = webdriver.Chrome(<span class="string">'G:\毕设\Boss_Recruitment\chromedriver.exe'</span>, options=option)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 类内的主要抓取函数</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_url</span><span class="params">(self, search=<span class="string">'python'</span>)</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        获取搜索职位的url, demo里面默认搜索python</span></span><br><span class="line"><span class="string">        :param search:</span></span><br><span class="line"><span class="string">        :return:</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 城市名和城市代码同步定位 城市名入库数据库 城市代码用于拼接访问链接</span></span><br><span class="line">        citys=[<span class="string">'北京'</span>,<span class="string">'上海'</span>,<span class="string">'广州'</span>,<span class="string">'深圳'</span>,<span class="string">'杭州'</span>,<span class="string">'天津'</span>,<span class="string">'西安'</span>,<span class="string">'武汉'</span>,<span class="string">'长沙'</span>,<span class="string">'成都'</span>,<span class="string">'郑州'</span>,<span class="string">'重庆'</span>]</span><br><span class="line">        city_codes = [<span class="string">'101010100'</span>,<span class="string">'101020100'</span>,<span class="string">'101280100'</span>,<span class="string">'101280600'</span>,<span class="string">'101210100'</span>,<span class="string">'101030100'</span>,<span class="string">'101110100'</span>,<span class="string">'101200100'</span>,<span class="string">'101250100'</span>,<span class="string">'101270100'</span>,<span class="string">'101180100'</span>,<span class="string">'101040100'</span>]</span><br><span class="line">        <span class="comment"># 爬取关键词列表</span></span><br><span class="line">        gangwei_lst = [<span class="string">"Java"</span>, <span class="string">"Python"</span>, <span class="string">"PHP"</span>, <span class="string">"安卓"</span>, <span class="string">"大数据"</span>, <span class="string">"c/c++"</span>,<span class="string">"前端"</span>]</span><br><span class="line">        <span class="comment"># 序号 作为数据库的唯一主键存在</span></span><br><span class="line">        xuhao = <span class="number">1</span></span><br><span class="line">        <span class="comment"># 遍历城市列表 用来访问所有城市的所有分类数据</span></span><br><span class="line">        <span class="keyword">for</span> city_num <span class="keyword">in</span> range(len(citys)):</span><br><span class="line">            <span class="comment"># 城市名 数据库字段</span></span><br><span class="line">            city = citys[city_num]</span><br><span class="line">            <span class="comment"># 遍历所有的分类列表 抓取所有城市的所有分类数据</span></span><br><span class="line">            <span class="keyword">for</span> search <span class="keyword">in</span> gangwei_lst:</span><br><span class="line">                <span class="keyword">for</span> y <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">11</span>):</span><br><span class="line">                    <span class="keyword">try</span>:</span><br><span class="line">                        self.driver.switch_to.window(sreach_window)</span><br><span class="line">                    <span class="keyword">except</span>:</span><br><span class="line">                        <span class="keyword">pass</span></span><br><span class="line">                    <span class="comment"># 链接c后面的数字即城市代码</span></span><br><span class="line">                    <span class="comment"># c 101020100 上海 101010100 北京 将城市代码拼接到访问链接来</span></span><br><span class="line">                    url = <span class="string">'https://www.zhipin.com/c'</span>+str(city_codes[city_num])+<span class="string">'/?query='</span> + str(search) + <span class="string">'&amp;page='</span> + str(y) + <span class="string">'&amp;ka=page-'</span> + str(y)</span><br><span class="line"></span><br><span class="line">                    self.driver.maximize_window()</span><br><span class="line">                    self.driver.get(url)</span><br><span class="line">                    time.sleep(<span class="number">3</span>)</span><br><span class="line">                    cookies = Cookies(self.driver)</span><br><span class="line">                    <span class="comment"># # 保存cookies</span></span><br><span class="line">                    <span class="comment"># cookies.save_cookies()</span></span><br><span class="line">                    <span class="comment"># 加载cookies</span></span><br><span class="line">                    <span class="comment"># cookies.add_cookies()</span></span><br><span class="line">                    self.driver.get(url)</span><br><span class="line">                    time.sleep(<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">                    <span class="comment"># 获取当前窗口</span></span><br><span class="line">                    sreach_window = self.driver.current_window_handle</span><br><span class="line">                    <span class="comment"># 每页有 30 条内容</span></span><br><span class="line">                    <span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">31</span>):</span><br><span class="line">                        data = []</span><br><span class="line">                        <span class="comment"># 如果被反扒有如下信息则跳过 否则即进入抓取部分</span></span><br><span class="line">                        <span class="keyword">try</span>:</span><br><span class="line">                            self.driver.find_element_by_xpath(<span class="string">"//*[text()='没有找到相关职位，修改筛选条件试一下']"</span>)</span><br><span class="line">                        <span class="keyword">except</span>:</span><br><span class="line">                            self.driver.switch_to.window(sreach_window)</span><br><span class="line"></span><br><span class="line">                            <span class="comment"># 查看是否可以匹配到id为 verifyMessage的模块 没有即被反扒</span></span><br><span class="line">                            <span class="keyword">try</span>:</span><br><span class="line">                                xpath_yanzhengma = self.driver.find_element_by_id(<span class="string">"verifyMessage"</span>).text</span><br><span class="line">                                print(xpath_yanzhengma)</span><br><span class="line">                                <span class="keyword">if</span> <span class="string">"当前IP地址可能存在异常访问行为，完成验证后即可正常使用"</span> <span class="keyword">in</span> xpath_yanzhengma:</span><br><span class="line">                                    print(<span class="string">'输入验证码验证'</span>)</span><br><span class="line">                                    os.system(<span class="string">"pause"</span>)</span><br><span class="line">                            <span class="keyword">except</span>:</span><br><span class="line">                                <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                            <span class="comment"># 公司名称</span></span><br><span class="line">                            <span class="keyword">try</span>:</span><br><span class="line">                                xpath_gongsi_name = <span class="string">'//*[@id="main"]/div/div[2]/ul/li['</span> + str(x) + <span class="string">']/div/div[1]/div[2]/div/h3/a'</span></span><br><span class="line">                                WebDriverWait(self.driver, <span class="number">60</span>, <span class="number">0.5</span>).until(EC.presence_of_element_located((By.XPATH, xpath_gongsi_name)))</span><br><span class="line">                                gongsi_name = self.driver.find_element_by_xpath(xpath_gongsi_name).text</span><br><span class="line"></span><br><span class="line">                            <span class="keyword">except</span>:</span><br><span class="line">                                print(<span class="string">'爬取完成！'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                            <span class="comment"># 薪资</span></span><br><span class="line">                            <span class="comment"># 定位 拼接遍历30个信息</span></span><br><span class="line">                            <span class="keyword">try</span>:</span><br><span class="line">                                xinzi = self.driver.find_element_by_xpath(<span class="string">'//*[@id ="main"]/div/div[2]/ul/li['</span> + str(x) + <span class="string">']/div/div[1]/div[1]/div/div[2]/span'</span>).text</span><br><span class="line"></span><br><span class="line">                            <span class="keyword">except</span>:</span><br><span class="line">                                xinzi = <span class="string">""</span></span><br><span class="line"></span><br><span class="line">                            <span class="comment"># 岗位名称</span></span><br><span class="line">                            <span class="keyword">try</span>:</span><br><span class="line">                                gangwei =self.driver.find_element_by_xpath(<span class="string">'//*[@id="main"]/div/div[2]/ul/li['</span> + str(x) + <span class="string">']/div/div[1]/div[1]/div/div[1]/span[1]/a'</span>).text</span><br><span class="line">                            <span class="keyword">except</span>:</span><br><span class="line">                                gangwei = <span class="string">""</span></span><br><span class="line"></span><br><span class="line">                            <span class="comment"># 工作经验</span></span><br><span class="line">                            <span class="keyword">try</span>:</span><br><span class="line">                                jingyan_xueli = self.driver.find_element_by_xpath(<span class="string">'//*[@id="main"]/div/div[2]/ul/li['</span> + str(x) + <span class="string">']/div/div[1]/div[1]/div/div[2]/p'</span>).text</span><br><span class="line">                                xueli = [<span class="string">'硕士'</span>, <span class="string">'大专'</span>, <span class="string">'本科'</span>, <span class="string">'博士'</span>, <span class="string">'专科'</span>]</span><br><span class="line">                                <span class="keyword">for</span> xue <span class="keyword">in</span> xueli:</span><br><span class="line">                                    <span class="keyword">if</span> xue <span class="keyword">in</span> jingyan_xueli:</span><br><span class="line">                                        gongsi_jingyan = jingyan_xueli.split(xue)[<span class="number">0</span>]</span><br><span class="line">                                        gongsi_xueli = jingyan_xueli.split(gongsi_jingyan)[<span class="number">1</span>]</span><br><span class="line">                                        <span class="keyword">break</span></span><br><span class="line">                            <span class="keyword">except</span>:</span><br><span class="line">                                gongsi_jingyan = <span class="string">""</span></span><br><span class="line">                                gongsi_xueli = <span class="string">""</span></span><br><span class="line"></span><br><span class="line">                            <span class="comment"># 公司行业</span></span><br><span class="line">                            <span class="keyword">try</span>:</span><br><span class="line">                                industry = self.driver.find_element_by_xpath(<span class="string">'//*[@id="main"]/div/div[2]/ul/li['</span> + str(x) + <span class="string">']/div/div[1]/div[2]/div/p/a'</span>).text</span><br><span class="line">                            <span class="keyword">except</span>:</span><br><span class="line">                                industry =<span class="string">''</span></span><br><span class="line"></span><br><span class="line">                            <span class="comment"># 融资阶段 和 公司规模提取</span></span><br><span class="line">                            <span class="keyword">try</span>:</span><br><span class="line">                            <span class="comment"># 融资情况和公司规模</span></span><br><span class="line">                                financing_size =self.driver.find_element_by_xpath(<span class="string">'//*[@id="main"]/div/div[2]/ul/li['</span> + str(x) + <span class="string">']/div/div[1]/div[2]/div/p'</span>).text.split(industry)[<span class="number">1</span>]</span><br><span class="line">                                <span class="comment"># 列举所有的融资情况 方便做切片</span></span><br><span class="line">                                rongzi = [<span class="string">'D轮及以上'</span>, <span class="string">'已上市'</span>, <span class="string">'C轮'</span>, <span class="string">'不需要融资'</span>, <span class="string">'B轮'</span>,<span class="string">'天使轮'</span>,<span class="string">'A轮'</span>]</span><br><span class="line">                                <span class="comment"># 遍历所有的融资情况</span></span><br><span class="line">                                <span class="keyword">for</span> rong <span class="keyword">in</span> rongzi:</span><br><span class="line">                                    <span class="comment"># 如果该融资情况在字符串中则进行匹配 然后break 跳出</span></span><br><span class="line">                                    <span class="comment"># 注意这里必须用 if 来判断 如果是for的话会遍历每一个字符</span></span><br><span class="line">                                    <span class="keyword">if</span> rong <span class="keyword">in</span> financing_size:</span><br><span class="line">                                        <span class="comment"># 用 融资 的状态做切片就可以得到公司规模</span></span><br><span class="line">                                        size = financing_size.split(rong)[<span class="number">1</span>]</span><br><span class="line">                                        <span class="comment"># 用 公司规模 做切片就可以得到融资</span></span><br><span class="line">                                        financing = financing_size.split(size)[<span class="number">0</span>]</span><br><span class="line">                                        <span class="keyword">break</span></span><br><span class="line">                            <span class="keyword">except</span>:</span><br><span class="line">                                <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">                            <span class="comment"># 技术点 直接存入数据库 他的字段是以空格隔开 我们可以在前端展示的时候切片即可</span></span><br><span class="line">                            <span class="keyword">try</span>:</span><br><span class="line">                                technicalPoint = self.driver.find_element_by_xpath(<span class="string">'//*[@id="main"]/div/div[2]/ul/li['</span> + str(x) + <span class="string">']/div/div[2]/div[1]'</span>).text</span><br><span class="line">                            <span class="keyword">except</span>:</span><br><span class="line">                                technicalPoint=<span class="string">''</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                            <span class="comment"># 添加到列表中输出进行查看</span></span><br><span class="line">                            data.append(xuhao)</span><br><span class="line">                            data.append(gongsi_name)</span><br><span class="line">                            data.append(gangwei)</span><br><span class="line">                            data.append(gongsi_xueli)</span><br><span class="line">                            data.append(gongsi_jingyan)</span><br><span class="line">                            data.append(xinzi)</span><br><span class="line">                            data.append(industry)</span><br><span class="line">                            data.append(financing)</span><br><span class="line">                            data.append(size)</span><br><span class="line">                            data.append(technicalPoint)</span><br><span class="line">                            print(data)</span><br><span class="line"></span><br><span class="line">                            <span class="comment"># 判断搜索的是什么岗位 然后写入表内对应的技术方向</span></span><br><span class="line">                            <span class="keyword">if</span> search == <span class="string">'Java'</span>:</span><br><span class="line">                                tableName = <span class="string">'java'</span></span><br><span class="line">                            <span class="keyword">elif</span> search == <span class="string">'Python'</span>:</span><br><span class="line">                                tableName = <span class="string">'python'</span></span><br><span class="line">                            <span class="keyword">elif</span> search == <span class="string">'PHP'</span>:</span><br><span class="line">                                tableName = <span class="string">'php'</span></span><br><span class="line">                            <span class="keyword">elif</span> search == <span class="string">'安卓'</span>:</span><br><span class="line">                                tableName = <span class="string">'android'</span></span><br><span class="line">                            <span class="keyword">elif</span> search == <span class="string">'c/c++'</span>:</span><br><span class="line">                                tableName = <span class="string">'c'</span></span><br><span class="line">                            <span class="keyword">elif</span> search == <span class="string">'前端'</span>:</span><br><span class="line">                                tableName = <span class="string">'index'</span></span><br><span class="line">                            <span class="keyword">else</span>:</span><br><span class="line">                                tableName = <span class="string">'data'</span></span><br><span class="line"></span><br><span class="line">                            <span class="comment"># 入库操作 本来应该写 try 但是为了避免出错无法排查 未添加鲁棒性</span></span><br><span class="line">                            sql_2 = <span class="string">"""</span></span><br><span class="line"><span class="string">                                    INSERT IGNORE INTO boss_all (id,company,post,education,operatinghours,salary,direction,city,industry,comsize,financing,technicalPoint)VALUES('&#123;&#125;','&#123;&#125;','&#123;&#125;','&#123;&#125;','&#123;&#125;','&#123;&#125;','&#123;&#125;','&#123;&#125;','&#123;&#125;','&#123;&#125;','&#123;&#125;','&#123;&#125;' )</span></span><br><span class="line"><span class="string">                                                """</span> \</span><br><span class="line">                                .format(</span><br><span class="line">                                xuhao,</span><br><span class="line">                                pymysql.escape_string(gongsi_name),</span><br><span class="line">                                pymysql.escape_string(gangwei),</span><br><span class="line">                                pymysql.escape_string(gongsi_xueli),</span><br><span class="line">                                pymysql.escape_string(gongsi_jingyan),</span><br><span class="line">                                pymysql.escape_string(xinzi),</span><br><span class="line">                                tableName,</span><br><span class="line">                                city,</span><br><span class="line">                                industry,</span><br><span class="line">                                size,</span><br><span class="line">                                financing,</span><br><span class="line">                                technicalPoint</span><br><span class="line">                            )</span><br><span class="line">                            <span class="comment"># print(sql_2)</span></span><br><span class="line">                            cursor.execute(sql_2)  <span class="comment"># 执行命令</span></span><br><span class="line">                            db.commit()  <span class="comment"># 提交事务</span></span><br><span class="line">                            print(<span class="string">"已完成"</span> + str(xuhao) + <span class="string">"条"</span>)</span><br><span class="line"></span><br><span class="line">                            xuhao += <span class="number">1</span></span><br><span class="line">                        <span class="keyword">else</span>:</span><br><span class="line">                            self.driver.refresh()</span><br><span class="line">                    <span class="comment"># 一页中休眠1-5s</span></span><br><span class="line">                    time.sleep(random.randint(<span class="number">1</span>, <span class="number">5</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    <span class="comment"># 爬虫部分</span></span><br><span class="line">    Boss().get_url()</span><br></pre></td></tr></table></figure>
<p>总共有 <strong>25781</strong> 条数据，具体字段如下<br><img src="5.png" alt></p>
<h1 id="Django"><a href="#Django" class="headerlink" title="Django"></a>Django</h1><p>有了数据之后我们需要通过 <strong>Echart</strong> 和 <strong>Django</strong> 的组合将其展示在 Web 页面上。</p>
<h2 id="Start-Django"><a href="#Start-Django" class="headerlink" title="Start Django"></a>Start Django</h2><p>我们使用 <strong>Pycharm</strong> 创建一个 <strong>Django Project</strong>，在设置中设置时区和语言，配置数据库的部分以及静态文件的引入路径</p>
<p><strong>Boss_Recruitment/settings.py</strong><br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">DATABASES = &#123;</span><br><span class="line">    <span class="string">'default'</span>: &#123;</span><br><span class="line">        <span class="string">'ENGINE'</span>: <span class="string">'django.db.backends.mysql'</span>,</span><br><span class="line">        <span class="string">'NAME'</span>: <span class="string">"boss_recruitment"</span>, <span class="comment"># 数据库名</span></span><br><span class="line">        <span class="string">'USER'</span>:<span class="string">"root"</span>,<span class="comment">#用户名</span></span><br><span class="line">        <span class="string">'PASSWORD'</span>:<span class="string">"password"</span>,<span class="comment">#用户密码</span></span><br><span class="line">        <span class="string">'HOST'</span>:<span class="string">"127.0.0.1"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">LANGUAGE_CODE = <span class="string">'zh-hans'</span> <span class="comment"># 语言</span></span><br><span class="line">TIME_ZONE = <span class="string">'Asia/Shanghai'</span> <span class="comment"># 时区</span></span><br><span class="line"></span><br><span class="line">STATIC_URL = <span class="string">'/static/'</span></span><br><span class="line">STATICFILES_DIRS =[</span><br><span class="line">    os.path.join(BASE_DIR,<span class="string">'static'</span>)</span><br><span class="line">]</span><br></pre></td></tr></table></figure></p>
<h2 id="APP"><a href="#APP" class="headerlink" title="APP"></a>APP</h2><p>有了 <strong>Project</strong> 之后，我们需要为后续的可视化新建一个 APP。进入 <strong>Terminal</strong>，输入如下命令创建 <code>python manage.py startapp citys_app</code>，然后我们就可以看到在该 Django 项目下有一个 <strong>citys_app</strong> 的文件夹，我们需要再次回到主项目的设置文件中将我们刚刚新建的 <strong>APP</strong> 进行注册</p>
<p><strong>Boss_Recruitment/settings.py</strong><br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">INSTALLED_APPS = [</span><br><span class="line">    <span class="string">'django.contrib.admin'</span>,</span><br><span class="line">    <span class="string">'django.contrib.auth'</span>,</span><br><span class="line">    <span class="string">'django.contrib.contenttypes'</span>,</span><br><span class="line">    <span class="string">'django.contrib.sessions'</span>,</span><br><span class="line">    <span class="string">'django.contrib.messages'</span>,</span><br><span class="line">    <span class="string">'django.contrib.staticfiles'</span>,</span><br><span class="line"></span><br><span class="line">    <span class="string">'citys_app'</span></span><br><span class="line">]</span><br></pre></td></tr></table></figure></p>
<h2 id="Index"><a href="#Index" class="headerlink" title="Index"></a>Index</h2><p>根据 <strong>MTV</strong> 原则，我们首先需要配置路由和视图函数。</p>
<p><strong>Boss_Recruitment/urls.py</strong><br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 导入 citys_app 中的视图函数 方便调用函数</span></span><br><span class="line"><span class="keyword">from</span> citys_app <span class="keyword">import</span> views</span><br><span class="line"></span><br><span class="line">urlpatterns = [</span><br><span class="line">    path(<span class="string">'admin/'</span>, admin.site.urls),</span><br><span class="line">    <span class="comment"># 首页调用视图函数</span></span><br><span class="line">    <span class="comment"># 给 HTML 的跳转链接的 &#123;% url 'home'%&#125;即可实现点击的跳转</span></span><br><span class="line">    path(<span class="string">''</span>,views.home,name=<span class="string">'home'</span>),</span><br><span class="line">]</span><br></pre></td></tr></table></figure></p>
<p><strong>citys_app/views.py</strong><br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.shortcuts <span class="keyword">import</span> render</span><br><span class="line"></span><br><span class="line"><span class="comment"># 首页</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">home</span><span class="params">(request)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> render(request,<span class="string">'index.html'</span>)</span><br></pre></td></tr></table></figure></p>
<p>需要注意两个部分的位置是不同的，我们直接在主项目的路由文件中引入我们的 APP 文件的视图函数即可实现路由和视图函数的连接。</p>
<p><strong>templates/index.html</strong> 该文件改版自 <a href="http://www.csszengarden.com/tr/zh-cn/" target="_blank" rel="noopener">CSS禅意花园</a> 此外我们需要将 <strong>css</strong> 文件导入到 <code>static/css</code> 下，然后我们在 <strong>HTML</strong> 的头部使用 <code>load static</code> 就可以在 <strong>css</strong> 引用中使用 <code>static &#39;css/index.css</code> 实现静态文件的引入。<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br></pre></td><td class="code"><pre><span class="line">&#123;% load static %&#125;</span><br><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Boss Recruitment - Data Analysis<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">media</span>=<span class="string">"screen"</span> <span class="attr">href</span>=<span class="string">"&#123;% static 'css/index.css' %&#125;"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"alternate"</span> <span class="attr">type</span>=<span class="string">"application/rss+xml"</span> <span class="attr">title</span>=<span class="string">"RSS"</span> <span class="attr">href</span>=<span class="string">"http://www.csszengarden.com/zengarden.xml"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"author"</span> <span class="attr">content</span>=<span class="string">"Dave Shea"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"description"</span> <span class="attr">content</span>=<span class="string">"A demonstration of what can be accomplished visually through CSS-based design."</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"robots"</span> <span class="attr">content</span>=<span class="string">"all"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line">        /* 头部的艺术字 */</span><br><span class="line">        h2&#123;</span><br><span class="line">            font-family:"CrimsonRoman", georgia, times, serif;</span><br><span class="line">            background-color:#c879b2;</span><br><span class="line">            margin: 2.5em 10% 0;</span><br><span class="line">            font-size:18px;</span><br><span class="line">            line-height:24px;</span><br><span class="line">            font-weight:bold;</span><br><span class="line">            text-align:center;</span><br><span class="line">            font-variant:small-caps;</span><br><span class="line">            word-spacing:.5em;</span><br><span class="line">            letter-spacing:.6em;</span><br><span class="line">            background-color: #f6efe5;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        h1 &#123;</span><br><span class="line">            font-size:40px;</span><br><span class="line">            line-height:96px;</span><br><span class="line">            font-family:"Pinyon Script", cursive;</span><br><span class="line">            margin:4px 0 -4px;</span><br><span class="line">            text-align:center;</span><br><span class="line">            font-weight:normal;</span><br><span class="line">            position:relative;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">'http://fonts.googleapis.com/css?family=Pinyon+Script'</span></span></span><br><span class="line"><span class="tag">        <span class="attr">rel</span>=<span class="string">'stylesheet'</span> <span class="attr">type</span>=<span class="string">'text/css'</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;<span class="name">body</span> <span class="attr">id</span>=<span class="string">"css-zen-garden"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>afrunk<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Boss Recruitment - Data Analysis<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"page-wrapper"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aside</span> <span class="attr">class</span>=<span class="string">"sidebar"</span> <span class="attr">role</span>=<span class="string">"complementary"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"wrapper"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"design-selection"</span> <span class="attr">id</span>=<span class="string">"design-selection"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">h3</span> <span class="attr">class</span>=<span class="string">"select"</span>&gt;</span>Citys<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">nav</span> <span class="attr">role</span>=<span class="string">"navigation"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"Fonet-end training notes\index.html"</span>  <span class="attr">class</span>=<span class="string">"design-name"</span>&gt;</span>Beijing<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">li</span>&gt;</span>                   <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"/220/"</span> <span class="attr">class</span>=<span class="string">"design-name"</span>&gt;</span>Shanghai<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">li</span>&gt;</span>                   <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"/219/"</span> <span class="attr">class</span>=<span class="string">"design-name"</span>&gt;</span>Guangzhou<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">li</span>&gt;</span>                   <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"/218/"</span> <span class="attr">class</span>=<span class="string">"design-name"</span>&gt;</span>Shenzhen<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">li</span>&gt;</span>                   <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"/217/"</span> <span class="attr">class</span>=<span class="string">"design-name"</span>&gt;</span>Hangzhou<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">li</span>&gt;</span>                   <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"/216/"</span> <span class="attr">class</span>=<span class="string">"design-name"</span>&gt;</span>Tianjin<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">li</span>&gt;</span>                   <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"/215/"</span> <span class="attr">class</span>=<span class="string">"design-name"</span>&gt;</span>Xian<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">li</span>&gt;</span>                   <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"/214/"</span> <span class="attr">class</span>=<span class="string">"design-name"</span>&gt;</span>Chengdu<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">li</span>&gt;</span>                   <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">nav</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">&lt;!-- &lt;div class="design-archives" id="design-archives"&gt;</span></span><br><span class="line"><span class="comment">                &lt;h3 class="archives"&gt;Archives:&lt;/h3&gt;</span></span><br><span class="line"><span class="comment">                &lt;nav role="navigation"&gt;</span></span><br><span class="line"><span class="comment">                    &lt;ul&gt;</span></span><br><span class="line"><span class="comment">                        &lt;li class="next"&gt;</span></span><br><span class="line"><span class="comment">                            &lt;a href="/214/page1"&gt;</span></span><br><span class="line"><span class="comment">                                Next Designs &lt;span class="indicator"&gt;&amp;rsaquo;&lt;/span&gt;</span></span><br><span class="line"><span class="comment">                            &lt;/a&gt;</span></span><br><span class="line"><span class="comment">                        &lt;/li&gt;</span></span><br><span class="line"><span class="comment">                        &lt;li class="viewall"&gt;</span></span><br><span class="line"><span class="comment">                            &lt;a href="http://www.mezzoblue.com/zengarden/alldesigns/" title="View every submission to the Zen Garden."&gt;</span></span><br><span class="line"><span class="comment">                                View All Designs                            &lt;/a&gt;</span></span><br><span class="line"><span class="comment">                        &lt;/li&gt;</span></span><br><span class="line"><span class="comment">                    &lt;/ul&gt;</span></span><br><span class="line"><span class="comment">                &lt;/nav&gt;</span></span><br><span class="line"><span class="comment">            &lt;/div&gt; --&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"zen-resources"</span> <span class="attr">id</span>=<span class="string">"zen-resources"</span>&gt;</span></span><br><span class="line">                <span class="comment">&lt;!-- &lt;h3 class="resources"&gt;Resources:&lt;/h3&gt; --&gt;</span></span><br><span class="line">                <span class="comment">&lt;!-- &lt;ul&gt; --&gt;</span></span><br><span class="line">                    <span class="comment">&lt;!-- &lt;li class="view-css"&gt;</span></span><br><span class="line"><span class="comment">                        &lt;a href="style.css" title="View the source CSS file of the currently-viewed design."&gt;</span></span><br><span class="line"><span class="comment">                            View This Design&amp;#8217;s &lt;abbr title="Cascading Style Sheets"&gt;CSS&lt;/abbr&gt;                        &lt;/a&gt;</span></span><br><span class="line"><span class="comment">                    &lt;/li&gt; --&gt;</span></span><br><span class="line">                    <span class="comment">&lt;!-- &lt;li class="css-resources"&gt;</span></span><br><span class="line"><span class="comment">                        &lt;a href="http://www.mezzoblue.com/zengarden/resources/" title="Links to great sites with information on using CSS."&gt;</span></span><br><span class="line"><span class="comment">                            &lt;abbr title="Cascading Style Sheets"&gt;CSS&lt;/abbr&gt; Resources                       &lt;/a&gt;</span></span><br><span class="line"><span class="comment">                    &lt;/li&gt;</span></span><br><span class="line"><span class="comment">                    &lt;li class="zen-faq"&gt;</span></span><br><span class="line"><span class="comment">                        &lt;a href="http://www.mezzoblue.com/zengarden/faq/" title="A list of Frequently Asked Questions about the Zen Garden."&gt;</span></span><br><span class="line"><span class="comment">                            &lt;abbr title="Frequently Asked Questions"&gt;FAQ&lt;/abbr&gt;                     &lt;/a&gt;</span></span><br><span class="line"><span class="comment">                    &lt;/li&gt;</span></span><br><span class="line"><span class="comment">                    &lt;li class="zen-submit"&gt;</span></span><br><span class="line"><span class="comment">                        &lt;a href="http://www.mezzoblue.com/zengarden/submit/" title="Send in your own CSS file."&gt;</span></span><br><span class="line"><span class="comment">                            Submit a Design                     &lt;/a&gt;</span></span><br><span class="line"><span class="comment">                    &lt;/li&gt;</span></span><br><span class="line"><span class="comment">                    &lt;li class="zen-translations"&gt;</span></span><br><span class="line"><span class="comment">                        &lt;a href="http://www.mezzoblue.com/zengarden/translations/" title="View translated versions of this page."&gt;</span></span><br><span class="line"><span class="comment">                            Translations                        &lt;/a&gt;</span></span><br><span class="line"><span class="comment">                    &lt;/li&gt; --&gt;</span></span><br><span class="line">                <span class="comment">&lt;!-- &lt;/ul&gt; --&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">aside</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p><img src="6.png" alt></p>
<h2 id="Models"><a href="#Models" class="headerlink" title="Models"></a>Models</h2><p>做好了首页之后，我们需要来构建 <strong>Model</strong> ，并将我们之前存入数据库表 <code>boss_all</code> 内的数据都存入后续 <strong>Django Models</strong> 中。因为我们只需要做可视化，不需要其他的任何操作，所以构建一个表即可，这个表的字段和我们之前的 <code>boss_all</code> 的字段一致。</p>
<p><strong>citys_app/models.py</strong><br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.db <span class="keyword">import</span> models</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create your models here.</span></span><br><span class="line"><span class="comment"># 招聘信息表</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Boss_all</span><span class="params">(models.Model)</span>:</span></span><br><span class="line">    <span class="comment"># id 唯一主键</span></span><br><span class="line">    id = models.IntegerField(primary_key=<span class="literal">True</span>,unique=<span class="literal">True</span>,default=<span class="number">0</span>)</span><br><span class="line">    <span class="comment"># 公司名</span></span><br><span class="line">    company = models.CharField(max_length=<span class="number">255</span>)</span><br><span class="line">    <span class="comment"># 职位名</span></span><br><span class="line">    post = models.CharField(max_length=<span class="number">255</span>)</span><br><span class="line">    <span class="comment"># 教育背景</span></span><br><span class="line">    education = models.CharField(max_length=<span class="number">255</span>)</span><br><span class="line">    <span class="comment"># 工作经验</span></span><br><span class="line">    operatinghours = models.CharField(max_length=<span class="number">255</span>)</span><br><span class="line">    <span class="comment"># 薪水</span></span><br><span class="line">    salary = models.CharField(max_length=<span class="number">50</span>)</span><br><span class="line">    <span class="comment"># 技术方向 java c ..</span></span><br><span class="line">    direction = models.CharField(max_length=<span class="number">50</span>)</span><br><span class="line">    <span class="comment"># 城市</span></span><br><span class="line">    city = models.CharField(max_length=<span class="number">25</span>)</span><br><span class="line">    <span class="comment"># 公司行业</span></span><br><span class="line">    industry = models.CharField(max_length=<span class="number">255</span>)</span><br><span class="line">    <span class="comment"># 公司规模</span></span><br><span class="line">    comsize = models.CharField(max_length=<span class="number">50</span>)</span><br><span class="line">    <span class="comment"># 融资情况</span></span><br><span class="line">    financing = models.CharField(max_length=<span class="number">50</span>)</span><br><span class="line">    <span class="comment"># 技术关键词</span></span><br><span class="line">    techinacalPoint = models.CharField(max_length=<span class="number">255</span>)</span><br></pre></td></tr></table></figure></p>
<p>构建好 <strong>Models</strong> ，我们需要将数据迁移到数据库，在 Terminal 中执行如下语句即可<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">(base) Boss_Recruitment&gt;python manage.py makemigrations</span><br><span class="line">Migrations for &apos;citys_app&apos;:</span><br><span class="line">  citys_app\migrations\0001_initial.py</span><br><span class="line">    - Create model Boss_all</span><br><span class="line"></span><br><span class="line">(base) Boss_Recruitment&gt;python manage.py migrate</span><br><span class="line">Operations to perform:</span><br><span class="line">  Apply all migrations: admin, auth, citys_app, contenttypes, sessions</span><br><span class="line">Running migrations:</span><br><span class="line">  Applying contenttypes.0001_initial... OK</span><br><span class="line">  Applying auth.0001_initial... OK</span><br><span class="line">  Applying admin.0001_initial... OK</span><br><span class="line">  Applying admin.0002_logentry_remove_auto_add... OK</span><br><span class="line">  Applying admin.0003_logentry_add_action_flag_choices... OK</span><br><span class="line">  Applying contenttypes.0002_remove_content_type_name... OK</span><br><span class="line">  Applying auth.0002_alter_permission_name_max_length... OK</span><br><span class="line">  Applying auth.0003_alter_user_email_max_length... OK</span><br><span class="line">  Applying auth.0004_alter_user_username_opts... OK</span><br><span class="line">  Applying auth.0005_alter_user_last_login_null... OK</span><br><span class="line">  Applying auth.0006_require_contenttypes_0002... OK</span><br><span class="line">  Applying auth.0007_alter_validators_add_error_messages... OK</span><br><span class="line">  Applying auth.0008_alter_user_username_max_length... OK</span><br><span class="line">  Applying auth.0009_alter_user_last_name_max_length... OK</span><br><span class="line">  Applying auth.0010_alter_group_name_max_length... OK</span><br><span class="line">  Applying auth.0011_update_proxy_permissions... OK</span><br><span class="line">  Applying citys_app.0001_initial... OK</span><br><span class="line">  Applying sessions.0001_initial... OK</span><br></pre></td></tr></table></figure></p>
<p>然后我们就可以在数据库的 <code>boss_recruitment</code> 库下找到如下的表和我们最关注的 <code>boss_all</code> Model 的实例化，在数据库中他会被命名为 <code>citys_app_boss_all</code></p>
<p><img src="7.png" alt></p>
<p><img src="8.png" alt></p>
<h2 id="Data"><a href="#Data" class="headerlink" title="Data"></a>Data</h2><p>有了数据库的表之后，我们需要将之前的抓取到的数据编写一个入库脚本，将数据都迁移到 <strong>Django Models</strong> 中去。</p>
<p><strong>data_makemigrations.py</strong><br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">将爬虫表中的数据迁移到 Django Models 中去</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> pymysql</span><br><span class="line">db = pymysql.connect(host=<span class="string">'127.0.0.1'</span>,</span><br><span class="line">                     port=<span class="number">3306</span>,</span><br><span class="line">                     user=<span class="string">'root'</span>,</span><br><span class="line">                     password=<span class="string">'password'</span>,</span><br><span class="line">                     db=<span class="string">'boss_recruitment'</span>,</span><br><span class="line">                     charset=<span class="string">'utf8'</span>)</span><br><span class="line">cursor = db.cursor()</span><br><span class="line"></span><br><span class="line">sql_1 = <span class="string">'select * from boss_all'</span></span><br><span class="line">cursor.execute(sql_1) <span class="comment"># 执行查询</span></span><br><span class="line"><span class="comment"># 列表化</span></span><br><span class="line">contents = cursor.fetchall()</span><br><span class="line"><span class="comment"># 遍历数据</span></span><br><span class="line"><span class="keyword">for</span> content <span class="keyword">in</span> contents:</span><br><span class="line">    print(content)</span><br><span class="line">    <span class="comment"># 入库操作</span></span><br><span class="line">    sql_2 = <span class="string">"""</span></span><br><span class="line"><span class="string">        INSERT IGNORE INTO citys_app_boss_all (id,company,post,education,operatinghours,salary,direction,city,industry,comsize,financing,technicalPoint)</span></span><br><span class="line"><span class="string">        VALUES('&#123;&#125;','&#123;&#125;','&#123;&#125;','&#123;&#125;','&#123;&#125;','&#123;&#125;','&#123;&#125;','&#123;&#125;','&#123;&#125;','&#123;&#125;','&#123;&#125;','&#123;&#125;' )</span></span><br><span class="line"><span class="string">            """</span> \</span><br><span class="line">        .format(</span><br><span class="line">        content[<span class="number">0</span>],</span><br><span class="line">        pymysql.escape_string(content[<span class="number">1</span>]),</span><br><span class="line">        pymysql.escape_string(content[<span class="number">2</span>]),</span><br><span class="line">        pymysql.escape_string(content[<span class="number">3</span>]),</span><br><span class="line">        pymysql.escape_string(content[<span class="number">4</span>]),</span><br><span class="line">        pymysql.escape_string(content[<span class="number">5</span>]),</span><br><span class="line">        pymysql.escape_string(content[<span class="number">6</span>]),</span><br><span class="line">        pymysql.escape_string(content[<span class="number">7</span>]),</span><br><span class="line">        pymysql.escape_string(content[<span class="number">8</span>]),</span><br><span class="line">        pymysql.escape_string(content[<span class="number">9</span>]),</span><br><span class="line">        pymysql.escape_string(content[<span class="number">10</span>]),</span><br><span class="line">        pymysql.escape_string(content[<span class="number">11</span>]),</span><br><span class="line">    )</span><br><span class="line">    <span class="comment"># print(sql_2)</span></span><br><span class="line">    cursor.execute(sql_2)  <span class="comment"># 执行命令</span></span><br><span class="line">    db.commit()  <span class="comment"># 提交事务</span></span><br></pre></td></tr></table></figure></p>
<p>很快，2万多条数据就直接进入到我们的 <code>citys_app_boss_all</code> 表中了，现在我们只需要写可视化页面即可。</p>
<p><img src="9.png" alt></p>
<h1 id="Echart-And-Django"><a href="#Echart-And-Django" class="headerlink" title="Echart And Django"></a>Echart And Django</h1><p>现在我们要使用 Django 的路由协议实现传入不同的城市参数，在同一个 HTML 页面上展示不同城市的数据可视化效果</p>
<p>我们需要了解 <strong>Django</strong> 的最新路由协议,如何来通过路由传入的参数实现视图函数通过不同参数的查询，并将结果反馈给前端。</p>
<h2 id="HTML、路由和视图函数-如何绑定"><a href="#HTML、路由和视图函数-如何绑定" class="headerlink" title="HTML、路由和视图函数 如何绑定"></a>HTML、路由和视图函数 如何绑定</h2><p>为什么我们在 HTML 页面中点击某个 a 标签的时候他可以正确的跳转到某个路由呢？我们先将实现这一效果的部分代码在下面进行解析</p>
<p><strong>templates/data_analysis.html</strong><br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"&#123;% url 'dataAnalysis' '北京' %&#125;"</span>  <span class="attr">class</span>=<span class="string">"design-name"</span>&gt;</span>Beijing<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>这是我们在 HTML 页面，也就是首页中设置的跳转链接，主要注意 href 中的文字，这种写法是固定的。你必须在外面写上 <strong>大括号+百分号</strong> ，否则无法奏效。其次我们为了能和路由的链接绑定起来，先声明为 <code>url</code> 即路由，再绑定我们在 路由设置中声明的别名，如果该路由设置需要传入参数，则在后面添加参数。为了更好的理解这段代码，我们将路由的设置也附上。</p>
<p><strong>Boss_Recruitment/urls.py</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 将城市路由和视图函数绑定 传入城市参数 视图函数查询当前城市的数据 进行展示</span><br><span class="line">path(&apos;/&lt;str:city&gt;&apos;,views.data_analysis,name =&apos;dataAnalysis&apos;),</span><br></pre></td></tr></table></figure></p>
<ol>
<li>我们在路由中使用 <code>&lt;&gt;</code> 的方式定义参数，如果该参数为字符串，则为 <code>str</code>，如果是整型，则为 <code>int</code> 。</li>
<li>name 是别名，也就是我们在 HTML 页面中 <code>url</code> 后面的名称 是为了与路由可以进行绑定</li>
<li>调用的视图函数我们也需要设置额外的接受参数，以便浏览器访问该路由时传过来的参数可以接受参与将其用于数据库的查询，避免报错。</li>
</ol>
<p><strong>citys_app/views.py</strong><br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 可视化页面</span></span><br><span class="line"><span class="comment"># 需要传入2个参数 request 和 city 方便我们查找各个城市的数据</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">data_analysis</span><span class="params">(request,city)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> render(request,<span class="string">'data_analysis.html'</span>)</span><br></pre></td></tr></table></figure></p>
<p>接受路由在 HTML 页面传给视图函数的参数 city，在上面我们解析的页面中该参数为 <strong>北京</strong>。然后通过对数据库的查询得到我们需要的城市的招聘数据，对其进行清洗，通过 <strong>Ajax</strong> 的方式传递给前端页面，然后使用 <strong>Echart</strong> 进行渲染得到可视化效果。</p>
<h2 id="完善视图函数"><a href="#完善视图函数" class="headerlink" title="完善视图函数"></a>完善视图函数</h2><p>该函数还只是可以通过传入不同的参数，都调用 <code>data_analysis.html</code> 页面，我们想要的是可以通过传入的参数查询数据库，并将不同的参数路由在同一个 HTML 页面上展示不同的可视化效果。<br>所以我们先来查询和清洗数据库的数据，拼接成我们需要的数据格式，再传递给前端页面。</p>
<p>首先，我先查询数据库的数据，然后做一个数据预处理。将某个地区的所有学历分布和平均薪资进行一个汇总得到两个列表</p>
<p><strong>django_analysis.py</strong><br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd <span class="comment"># 使用pandas处理数据库的数据</span></span><br><span class="line"><span class="comment"># 配置 pymysql 方便 pandas 调用</span></span><br><span class="line"><span class="keyword">import</span> pymysql</span><br><span class="line">db = pymysql.connect(host=<span class="string">'127.0.0.1'</span>,</span><br><span class="line">                     port=<span class="number">3306</span>,</span><br><span class="line">                     user=<span class="string">'root'</span>, <span class="comment"># 数据库用户名字</span></span><br><span class="line">                     password=<span class="string">'password'</span>, <span class="comment"># 数据库密码</span></span><br><span class="line">                     db=<span class="string">'boss_recruitment'</span>,<span class="comment"># 数据库的名字</span></span><br><span class="line">                     charset=<span class="string">'utf8'</span>)</span><br><span class="line">cityKey=<span class="string">'北京'</span></span><br><span class="line">courses = pd.read_sql(<span class="string">'select * from citys_app_boss_all'</span>, db)</span><br><span class="line"><span class="comment"># print(type(courses))</span></span><br><span class="line"><span class="comment"># 提取某个城市的数据进行数据处理 提取需要进行可视化展示的部分</span></span><br><span class="line">data = courses[courses[<span class="string">'city'</span>] == cityKey]</span><br><span class="line"><span class="comment"># 清洗数据 去除空值</span></span><br><span class="line">resultData = data.dropna(axis=<span class="number">0</span>,how=<span class="string">'any'</span>,thresh=<span class="literal">None</span>,subset = <span class="literal">None</span>,inplace=<span class="literal">False</span>)</span><br><span class="line"><span class="comment"># 学历划分</span></span><br><span class="line">education_list =[<span class="string">'本科'</span>,<span class="string">'专科'</span>,<span class="string">'硕士'</span>,<span class="string">'博士'</span>]</span><br><span class="line"><span class="comment"># 上面构建好的各个数据库的名称合并后的方向分类列表</span></span><br><span class="line">direction_list =[<span class="string">"java"</span>, <span class="string">"python"</span>, <span class="string">"php"</span>, <span class="string">"android"</span>, <span class="string">"index"</span>, <span class="string">"c"</span>,<span class="string">"data"</span>]</span><br><span class="line">nums_list = []</span><br><span class="line"><span class="comment"># 存储每个方向的一个学历列表 二维列表</span></span><br><span class="line">directions_list = []</span><br><span class="line"><span class="comment"># 遍历列表 将每个方向的数据进行提取 获取整体的数据</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> direction_list:</span><br><span class="line">    directions = [<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>]</span><br><span class="line">    <span class="comment"># 对给个方向的数据进行计数 然后转化为字典 方便后续遍历整理成列表形式</span></span><br><span class="line">    educations = dict(resultData[resultData[<span class="string">'direction'</span>]==i][<span class="string">'education'</span>].value_counts())</span><br><span class="line">    <span class="comment"># 删除空缺值</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        educations.pop(<span class="string">''</span>)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="comment"># 遍历字典</span></span><br><span class="line">    <span class="keyword">for</span> key <span class="keyword">in</span> educations:</span><br><span class="line">        <span class="keyword">if</span> key==<span class="string">'本科'</span>:</span><br><span class="line">            directions[<span class="number">0</span>] = educations[key]</span><br><span class="line">        <span class="keyword">elif</span> key == <span class="string">'大专'</span>:</span><br><span class="line">            directions[<span class="number">1</span>] = educations[key]</span><br><span class="line">        <span class="keyword">elif</span> key == <span class="string">'硕士'</span>:</span><br><span class="line">            directions[<span class="number">2</span>] = educations[key]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            directions[<span class="number">3</span>] = educations[key]</span><br><span class="line">    directions_list.append(directions)</span><br><span class="line">print(directions_list)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 所有学历的列表人数</span></span><br><span class="line">all_directions_list =[<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>]</span><br><span class="line"><span class="comment"># 遍历分类的列表中的数据 然后将本科、专科、硕士、博士的数据进行累加</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(directions_list)):</span><br><span class="line">    <span class="comment"># 累加本科</span></span><br><span class="line">    all_directions_list[<span class="number">0</span>] +=directions_list[i][<span class="number">0</span>]</span><br><span class="line">    all_directions_list[<span class="number">1</span>] += directions_list[i][<span class="number">1</span>]</span><br><span class="line">    all_directions_list[<span class="number">2</span>] += directions_list[i][<span class="number">2</span>]</span><br><span class="line">    all_directions_list[<span class="number">3</span>] += directions_list[i][<span class="number">3</span>]</span><br><span class="line">print(all_directions_list)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 薪资水平可视化</span></span><br><span class="line"><span class="comment"># result['xinzi']</span></span><br><span class="line">pattern = <span class="string">'\d+'</span></span><br><span class="line"><span class="comment"># 将数据中的横线去掉</span></span><br><span class="line">resultData[<span class="string">'salary'</span>] = resultData[<span class="string">'salary'</span>].str.findall(pattern)</span><br><span class="line"><span class="comment"># 存储我们求出后的平均工资</span></span><br><span class="line">avg_salary_list = []</span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> resultData[<span class="string">'salary'</span>]:</span><br><span class="line">        <span class="comment"># 遍历去掉横线后的两端工资</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            int_list=[<span class="number">0</span>,<span class="number">0</span>]</span><br><span class="line">            int_list = [int(n) <span class="keyword">for</span> n <span class="keyword">in</span> k][:<span class="number">2</span>]</span><br><span class="line"><span class="comment">#             print(int_list)</span></span><br><span class="line">            <span class="comment"># 求平均工资</span></span><br><span class="line">            avg_salary =(int_list[<span class="number">1</span>] + int_list[<span class="number">0</span>])/<span class="number">2</span></span><br><span class="line"><span class="comment">#             print(avg_salary)</span></span><br><span class="line">    <span class="comment">#         # 添加到列表然后赋值给DataFrame变量</span></span><br><span class="line">            avg_salary_list.append(avg_salary)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            avg_salary_list.append(<span class="number">0</span>)</span><br><span class="line"><span class="comment"># 计算出来工资区间的平均值之后复制给我们的DataFrame变量</span></span><br><span class="line">resultData[<span class="string">'salary'</span>] = avg_salary_list</span><br><span class="line">mean_salary = []</span><br><span class="line"><span class="comment"># 求某一个分区的平均工资是多少</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span>  direction_list:</span><br><span class="line">    <span class="comment"># print(resultData[resultData['direction']==i]['salary'].mean())</span></span><br><span class="line">    mean_salary.append(resultData[resultData[<span class="string">'direction'</span>]==i][<span class="string">'salary'</span>].mean())</span><br><span class="line"></span><br><span class="line"><span class="comment"># 行业的平均工资</span></span><br><span class="line">print(mean_salary)</span><br></pre></td></tr></table></figure></p>
<p>然后将这两个列表传入给 HTML 页面，总结到视图函数中去<br><strong>citys_app/views.py</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 可视化页面</span></span><br><span class="line"><span class="comment"># 需要传入2个参数 request 和 city 方便我们查找各个城市的数据</span></span><br><span class="line"><span class="keyword">from</span> .models <span class="keyword">import</span> Boss_all <span class="comment"># 传入Models 的数据模型 便于查询</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd <span class="comment"># 使用pandas处理数据库的数据</span></span><br><span class="line"><span class="comment"># 配置 pymysql 方便 pandas 调用</span></span><br><span class="line"><span class="keyword">import</span> pymysql</span><br><span class="line">db = pymysql.connect(host=<span class="string">'127.0.0.1'</span>,</span><br><span class="line">                     port=<span class="number">3306</span>,</span><br><span class="line">                     user=<span class="string">'root'</span>, <span class="comment"># 数据库用户名字</span></span><br><span class="line">                     password=<span class="string">'password'</span>, <span class="comment"># 数据库密码</span></span><br><span class="line">                     db=<span class="string">'boss_recruitment'</span>,<span class="comment"># 数据库的名字</span></span><br><span class="line">                     charset=<span class="string">'utf8'</span>)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">data_analysis</span><span class="params">(request,cityKey)</span>:</span></span><br><span class="line">    <span class="comment"># 查询数据库的表 然后获取数据</span></span><br><span class="line">    courses = pd.read_sql(<span class="string">'select * from citys_app_boss_all'</span>, db)</span><br><span class="line">    <span class="comment"># print(type(courses))</span></span><br><span class="line">    <span class="comment"># 提取某个城市的数据进行数据处理 提取需要进行可视化展示的部分</span></span><br><span class="line">    data = courses[courses[<span class="string">'city'</span>]==cityKey]</span><br><span class="line">    <span class="comment"># 清洗数据 去除空值</span></span><br><span class="line">    resultData = data.dropna(axis=<span class="number">0</span>, how=<span class="string">'any'</span>, thresh=<span class="literal">None</span>, subset=<span class="literal">None</span>, inplace=<span class="literal">False</span>)</span><br><span class="line">    <span class="comment"># 学历划分</span></span><br><span class="line">    education_list = [<span class="string">'本科'</span>, <span class="string">'专科'</span>, <span class="string">'硕士'</span>, <span class="string">'博士'</span>]</span><br><span class="line">    <span class="comment"># 上面构建好的各个数据库的名称合并后的方向分类列表</span></span><br><span class="line">    direction_list = [<span class="string">"java"</span>, <span class="string">"python"</span>, <span class="string">"php"</span>, <span class="string">"android"</span>, <span class="string">"index"</span>, <span class="string">"c"</span>, <span class="string">"data"</span>]</span><br><span class="line">    nums_list = []</span><br><span class="line">    <span class="comment"># 存储每个方向的一个学历列表 二维列表</span></span><br><span class="line">    directions_list = []</span><br><span class="line">    <span class="comment"># 遍历列表 将每个方向的数据进行提取 获取整体的数据</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> direction_list:</span><br><span class="line">        directions = [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>]</span><br><span class="line">        <span class="comment"># 对给个方向的数据进行计数 然后转化为字典 方便后续遍历整理成列表形式</span></span><br><span class="line">        educations = dict(resultData[resultData[<span class="string">'direction'</span>] == i][<span class="string">'education'</span>].value_counts())</span><br><span class="line">        <span class="comment"># 删除空缺值</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            educations.pop(<span class="string">''</span>)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">        <span class="comment"># 遍历字典</span></span><br><span class="line">        <span class="keyword">for</span> key <span class="keyword">in</span> educations:</span><br><span class="line">            <span class="keyword">if</span> key == <span class="string">'本科'</span>:</span><br><span class="line">                directions[<span class="number">0</span>] = educations[key]</span><br><span class="line">            <span class="keyword">elif</span> key == <span class="string">'大专'</span>:</span><br><span class="line">                directions[<span class="number">1</span>] = educations[key]</span><br><span class="line">            <span class="keyword">elif</span> key == <span class="string">'硕士'</span>:</span><br><span class="line">                directions[<span class="number">2</span>] = educations[key]</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                directions[<span class="number">3</span>] = educations[key]</span><br><span class="line">        directions_list.append(directions)</span><br><span class="line">    print(directions_list)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 所有学历的列表人数</span></span><br><span class="line">    all_directions_list = [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>]</span><br><span class="line">    <span class="comment"># 遍历分类的列表中的数据 然后将本科、专科、硕士、博士的数据进行累加</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(directions_list)):</span><br><span class="line">        <span class="comment"># 累加本科</span></span><br><span class="line">        all_directions_list[<span class="number">0</span>] += directions_list[i][<span class="number">0</span>]</span><br><span class="line">        all_directions_list[<span class="number">1</span>] += directions_list[i][<span class="number">1</span>]</span><br><span class="line">        all_directions_list[<span class="number">2</span>] += directions_list[i][<span class="number">2</span>]</span><br><span class="line">        all_directions_list[<span class="number">3</span>] += directions_list[i][<span class="number">3</span>]</span><br><span class="line">    <span class="comment"># 北京招聘的学历分布列表</span></span><br><span class="line">    print(all_directions_list)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 薪资水平可视化</span></span><br><span class="line">    <span class="comment"># result['xinzi']</span></span><br><span class="line">    pattern = <span class="string">'\d+'</span></span><br><span class="line">    <span class="comment"># 将数据中的横线去掉</span></span><br><span class="line">    resultData[<span class="string">'salary'</span>] = resultData[<span class="string">'salary'</span>].str.findall(pattern)</span><br><span class="line">    <span class="comment"># 存储我们求出后的平均工资</span></span><br><span class="line">    avg_salary_list = []</span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> resultData[<span class="string">'salary'</span>]:</span><br><span class="line">        <span class="comment"># 遍历去掉横线后的两端工资</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            int_list = [<span class="number">0</span>, <span class="number">0</span>]</span><br><span class="line">            int_list = [int(n) <span class="keyword">for</span> n <span class="keyword">in</span> k][:<span class="number">2</span>]</span><br><span class="line">            <span class="comment">#             print(int_list)</span></span><br><span class="line">            <span class="comment"># 求平均工资</span></span><br><span class="line">            avg_salary = (int_list[<span class="number">1</span>] + int_list[<span class="number">0</span>]) / <span class="number">2</span></span><br><span class="line">            <span class="comment">#             print(avg_salary)</span></span><br><span class="line">            <span class="comment">#         # 添加到列表然后赋值给DataFrame变量</span></span><br><span class="line">            avg_salary_list.append(avg_salary)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            avg_salary_list.append(<span class="number">0</span>)</span><br><span class="line">    <span class="comment"># 计算出来工资区间的平均值之后复制给我们的DataFrame变量</span></span><br><span class="line">    resultData[<span class="string">'salary'</span>] = avg_salary_list</span><br><span class="line">    mean_salary = []</span><br><span class="line">    <span class="comment"># 求某一个分区的平均工资是多少</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> direction_list:</span><br><span class="line">        <span class="comment"># print(resultData[resultData['direction']==i]['salary'].mean())</span></span><br><span class="line">        mean_salary.append(resultData[resultData[<span class="string">'direction'</span>] == i][<span class="string">'salary'</span>].mean())</span><br><span class="line">    <span class="comment"># 行业的平均工资</span></span><br><span class="line">    print(mean_salary)</span><br><span class="line">    <span class="keyword">return</span> render(request,<span class="string">'data_analysis.html'</span>,&#123;<span class="string">'all_directions_list'</span>:all_directions_list,<span class="string">'mean_salary'</span>:mean_salary&#125;)</span><br></pre></td></tr></table></figure>
<h2 id="Echart-Ajax-调用数据可视化"><a href="#Echart-Ajax-调用数据可视化" class="headerlink" title="Echart Ajax 调用数据可视化"></a>Echart Ajax 调用数据可视化</h2><p>数据传递给了前端，到了这里，我们就需要使用 Echart 来进行数据可视化了。</p>
<p><strong>templates/data_analysis.html</strong><br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line">&#123;% load static %&#125;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=<span class="string">"en"</span>&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=<span class="string">"UTF-8"</span>&gt;</span><br><span class="line">    &lt;title&gt;Data Analysis / &#123;&#123; cityKey &#125;&#125; &lt;/title&gt;</span><br><span class="line">    &lt;style&gt;</span><br><span class="line">&#123;<span class="comment">#        设置文字和可视化图表居中对齐  #&#125;</span></span><br><span class="line">        .center&#123;</span><br><span class="line">            margin:<span class="number">0</span> auto;width:<span class="number">1500</span>px; text-align:center;</span><br><span class="line">        &#125;</span><br><span class="line">    &lt;/style&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;div class="center"&gt;</span><br><span class="line">        &lt;h1&gt;&lt;a href="&#123;% url 'home' %&#125;"&gt;Data analysis &lt;/a&gt;- &#123;&#123; cityKey &#125;&#125;&lt;/h1&gt;</span><br><span class="line">        &lt;div class="main_table t_btn3" id="chart_1" style="width: 100%; height: 280px; -webkit-tap-highlight-color: transparent; user-select: none; position: relative;"&gt;&lt;/div&gt;</span><br><span class="line">        &lt;div class="main_table t_btn3" id="chart_2" style="width: 100%; height: 280px; -webkit-tap-highlight-color: transparent; user-select: none; position: relative;"&gt;&lt;/div&gt;</span><br><span class="line">        &lt;div class="main_table t_btn3" id="chart_3" style="width: 100%; height: 280px; -webkit-tap-highlight-color: transparent; user-select: none; position: relative;"&gt;&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">        &lt;script src="&#123;% static 'js/echarts.js' %&#125;"&gt;&lt;/script&gt;</span><br><span class="line">        &lt;script type=<span class="string">"text/javascript"</span>&gt;</span><br><span class="line">            // 基于准备好的dom，初始化echarts实例</span><br><span class="line">            console.log(name);</span><br><span class="line">        var myChart1= echarts.init(document.getElementById(<span class="string">'chart_1'</span>));</span><br><span class="line">            // 指定图表的配置项和数据</span><br><span class="line">            var option1 = &#123;</span><br><span class="line">                title: &#123;</span><br><span class="line">                    text: <span class="string">'&#123;&#123; cityKey &#125;&#125;学历人数柱状图'</span></span><br><span class="line">                &#125;,</span><br><span class="line">                tooltip: &#123;&#125;,</span><br><span class="line">                legend: &#123;</span><br><span class="line">                    data:[<span class="string">'学历人数'</span>]</span><br><span class="line">                &#125;,</span><br><span class="line">                xAxis: &#123;</span><br><span class="line">                    data: &#123;&#123; education_list|safe &#125;&#125;</span><br><span class="line">                &#125;,</span><br><span class="line">                yAxis: &#123;&#125;,</span><br><span class="line">                series: [&#123;</span><br><span class="line">                    name: <span class="string">'学历人数'</span>,</span><br><span class="line">                    type: <span class="string">'bar'</span>,</span><br><span class="line">                    data:&#123;&#123; all_directions_list|safe &#125;&#125;</span><br><span class="line">                &#125;]</span><br><span class="line">            &#125;;</span><br><span class="line"></span><br><span class="line">            // 使用刚指定的配置项和数据显示图表。</span><br><span class="line">            myChart1.setOption(option1);</span><br><span class="line"></span><br><span class="line">            var myChart2= echarts.init(document.getElementById(<span class="string">'chart_2'</span>));</span><br><span class="line">            // 指定图表的配置项和数据</span><br><span class="line">            var option2 = &#123;</span><br><span class="line">                title: &#123;</span><br><span class="line">                    text: <span class="string">'&#123;&#123; cityKey &#125;&#125;平均工资柱状图'</span></span><br><span class="line">                &#125;,</span><br><span class="line">                tooltip: &#123;&#125;,</span><br><span class="line">                legend: &#123;</span><br><span class="line">                    data:[<span class="string">'平均工资'</span>]</span><br><span class="line">                &#125;,</span><br><span class="line">                xAxis: &#123;</span><br><span class="line">                    data: &#123;&#123; direction_list|safe &#125;&#125;</span><br><span class="line">                &#125;,</span><br><span class="line">                yAxis: &#123;&#125;,</span><br><span class="line">                series: [&#123;</span><br><span class="line">                    name: <span class="string">'平均工资'</span>,</span><br><span class="line">                    type: <span class="string">'bar'</span>,</span><br><span class="line">                    data:&#123;&#123; mean_salary|safe &#125;&#125;</span><br><span class="line">                &#125;]</span><br><span class="line">            &#125;;</span><br><span class="line"></span><br><span class="line">            // 使用刚指定的配置项和数据显示图表。</span><br><span class="line">            myChart2.setOption(option2);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &lt;/script&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p>
<p><img src="10.png" alt></p>
<h1 id="Conclusions"><a href="#Conclusions" class="headerlink" title="Conclusions"></a>Conclusions</h1><p>难点分析 </p>
<ol>
<li>一开始的难点在于爬虫的实现，如何躲开反爬策略。</li>
<li>其次在于如何将路由、HTML、视图函数的参数传递流程理清楚。</li>
<li>最后是如何实现 AJAX 和 Echart 数据的交互。</li>
</ol>
<p>只要搞清楚了这三个点，本项目基本上没有难以理解的地方。</p>
<p>效果如下<br><img src="Last.gif" alt></p>
<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ul>
<li><a href="https://blog.csdn.net/qq_28949847/article/details/104925064" target="_blank" rel="noopener">Boss直聘招聘信息爬取</a> : <code>Selenium</code> 的常用写法 ,代码过期 仅供参考</li>
<li><a href="https://mp.weixin.qq.com/s?__biz=MzI5ODQxNTA0OA==&amp;mid=2247484133&amp;idx=1&amp;sn=b435a1e64d94b4e14fe588adb2aa26d7&amp;chksm=eca76442dbd0ed540c0b849fb19198e909e1a05ccb308b65124fc9ba13997dc20fdc5360922d&amp;token=313076169&amp;lang=zh_CN" target="_blank" rel="noopener">Boss直聘爬虫第2弹：selenium找不到元素的常见问题</a> ： 解决模拟登陆被识别 <code>Selenium</code> 的问题</li>
<li><a href="https://blog.csdn.net/qq_32227401/article/details/79997680" target="_blank" rel="noopener">Django 基础教程</a></li>
</ul>

      </div>
      
      <footer class="post-footer">
        <div class="post-tags">
            <a href="/tags/Django/">Django</a>
            </div>
        
        <nav class="post-nav"><a class="next" href="/2020/03/27/18-Django-mooc-Spider/">
        <span class="next-text nav-default">Django_mooc_Spider</span>
        <span class="prev-text nav-mobile">下一篇</span>
        <i class="iconfont icon-right"></i>
      </a>
    </nav></footer>
    </article></div><div class="comments" id="comments"></div></div>
      </main>

      <footer id="footer" class="footer"><div class="social-links"><a href="mailto:afrunk7@gmail.com" class="iconfont icon-email" title="email"></a>
        <a href="https://github.com/afrunk" class="iconfont icon-github" title="github"></a>
        <a href="/atom.xml" class="iconfont icon-rss" title="rss"></a>
    </div><div class="copyright">
  <span class="power-by">
    由 <a class="hexo-link" href="https://hexo.io/">Hexo</a> 强力驱动
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    主题 - 
    <a class="theme-link" href="https://github.com/ahonn/hexo-theme-even">Even</a>
  </span>

  <span class="copyright-year">&copy;2019 - 2020<span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">Afrunk</span>
  </span>
</div>
</footer>

      <div class="back-to-top" id="back-to-top">
        <i class="iconfont icon-up"></i>
      </div>
    </div><script type="text/javascript" src="/lib/jquery/jquery.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout.js"></script>
  <script type="text/javascript" src="/lib/fancybox/jquery.fancybox.pack.js"></script>
  <script type="text/javascript" src="/lib/pjax/jquery.pjax.min.js"></script>
  <script type="text/javascript" src="/lib/nprogress/nprogress.min.js"></script>
  <script type="text/javascript" src="/js/src/even.js?v=2.11.0"></script>
</body>
</html>
